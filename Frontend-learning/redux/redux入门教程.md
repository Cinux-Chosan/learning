# Redux 入门教程

## 前言

### 编写目的

本文的目的意在帮助新手能够快速上手 redux 开发。

## 目录

## 内容

很多朋友在刚接触 redux 的时候会感到各种迷茫。如果你是刚接触 redux 的迷茫小孩，那请跟着我的思路一步一步来。这里我们先从为什么要使用 redux 开始。

React 官方文档中提到一种情况，简单说来就是多层组件之间的传值问题，假设有如下层次结构的 3 个组件：

      - A
        - B
          - C

C 属于 B 的子组件，B 属于 A 的子组件。

现在组件 C 需要用到 A 中的某个值，怎么做呢？官方文档中给出的解决方案简单暴力 —— 向下传值：即 A 将值传给 B，B 再传给 C（官方文档中还提到一种控制反转的方式）。这样做看似合情合理，但问题也很明显：

> - B 作为 A 到 C 传值的中转层，这部分数据对 B 来说没有任何作用
> - 随着参数个数的增加代码会变得越来越冗余，并且难以维护
> - 降低了组件 B 的灵活性

我们需要把它干掉！

怎么干掉呢？我们可以把数据从组件中抽离出来单独存放在一个对象里，假设这个对象就叫 Store。组件要用到对应的数据时，去 Store 中拿就 OK 了，Store 中数据如果发生了变化，通知对应的组件更新即可，现在思路就简单多了：

      - A <------------>  ---------
        - B <----------> |  Store  |
          - C <-------->  ---------
                              ^
                              |
      - D <-------------------

此时 C 还是 B 的子组件，B 还是 A 的子组件，但 A、B、C 都订阅了 Store 中的数据，此外还添加了组件 D，它同样从 Store 订阅了数据。当 ABCD 中任意一个组件更新了 Store 中的数据时，Store 就会通知所有其他组件重新获取数据。

这样一来，数据完全就可以共享了，并且还不用关心是不是在同一层级中（向下传值的情况无法解决不同层级树中组件值共享的问题）。

你如果理解了上面的模型，你其实就已经懂 Redux 了。

此外，redux 还有其他使用场景，如：

- props 需要向下传递多层组件
- 在不同的视图之间缓存数据提升访问速度
- 同一份数据可能有多个不同的 UI 展示方式时
- 防止热重载时组件内的状态数据被清除掉
- 应用越来越大，管理的数据越来越多的情况

## 参考资料

- [What Does Redux Do? (and when should you use it?)](https://daveceddia.com/what-does-redux-do/)
- [Redux vs plain React](https://stackoverflow.com/questions/39260769/redux-vs-plain-react/39261546#39261546)