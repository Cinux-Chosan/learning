# DOM

文档元素是文档最外层的元素，如在 HTML 中为 `<html>` 元素。

总共有12中节点类型

## 10.1.1 Node类型

DOM1 定义了一个 Node 接口（IE 中不可访问），该接口将由 DOM 中的所有节点类型实现。JavaScript中所有节点类型都继承自 Node 类型，因此所有节点类型都共享着相同的基本属性和方法。

每个节点都有一个 nodeType 属性，它用于表明节点的类型。节点类型由在 Node 类型中定义的下列 12 个数值常量来表示，任何节点类型必居其一：
- Node.ELEMENT_NODE(1)
- Node.ATTRIBUTE_NODE(2)
- Node.TEXT_NODE(3)
- Node.CDATA_SECTION_NODE(4)
- Node.ENTITY_REFERENCE_NODE(5)
- Node.ENTITY_NODE(6)
- Node.PROCESSING_INSTRUCTION_NODE(7)
- Node.COMMENT_NODE(8)
- Node.DOCUMENT_NODE(9)
- Node.DOCUMENT_TYPE_NODE(10)
- Node.DOCUMENT_FRAGMENT_NODE(11)
- Node.NOTATION_NODE(12)

由于 IE 中不可访问 Node 对象，因此下面的代码应该使用数值型：

```js
if (someNode.nodeType == Node.ELEMENT_NODE) { // IE 中无效，因为无法访问 Node
  // TODO
}
```

换成：

```js
if (someNode.nodeType == 1) { // 使用节点的数字值，兼容所有浏览器
  // TODO
}
```

#### nodeName 和 nodeValue

nodeName 获取节点名，nodeValue 获取节点值。

```js
if (someNode.nodeType == 1) {  // 使用之前先检测节点类型，看它是不是一个元素
  value = someNode.nodeName;
}
```

对于元素节点，nodeName 中保存的始终是元素的标签名，而 nodeValue 的值**始终为 null（即便是一个 input 元素）**。

#### 节点关系

每个节点都有一个 childNodes 属性，它是一个 NodeList 对象。需要注意的是：
- NodeList 虽然可以通过 `[]` 访问，并且也有 length 属性，但它并不是 Array 的实例
- NodeList 是基于 DOM 结构动态执行查询的结果，因此 DOM 结构的变化能够自动反映在 NodeList 对象中。我们常说，NodeList 是有生命、有呼吸的对象，而不是我们第一次访问它的某个瞬间拍摄下来的一个快照。

```js
var firstChild = someNode.childNodes[0];
var secondChild = someNode.childNodes.item(1);
var count = someNode.childNodes.length;
```

**每个节点**都有一个 parentNode 属性，该属性指向文档树中的父节点。包含在 childNodes 列表中的所有节点都具有相同的父节点，因此它们的 parentNode 属性都指向同一个节点。此外，包含在 childNodes 列表中的每个节点之间互相都是同胞节点。通过使用列表中每个节点的 previousSibling 和 nextSibling 属性，可以访问同一列表中的其他节点。列表中第一个节点的 previousSibling 属性值为 null，而列表中最后一个节点的 nextSibling 属性值同样也为 null：

```js
if (someNode.nextSibling === null) {
  alert('this is the last node');
} else if (someNode.previousSibling === null) {
  alert('this is the first node');
}
```

同时，父节点的 firstChild 和 lastChild 分别始终指向其 childNodes 列表中的第一个和最后一个节点。明确这些关系能够对我们查找和访问文档结构中的节点提供极大的便利。

另外，`hasChildNodes()` 也是一个非常有用的方法，这个方法在节点包含一个或多个子节点的情况下返回 true；应该说，这是比查询 childNodes 列表的 length 属性更简单的方法。

**所有节点都有的**最后一个属性是 `ownerDocument`，该属性指向表示整个文档的文档节点。通过这个属性，我们可以不必在节点层次中层层回溯到达顶端，而是可以直接访问文档节点。